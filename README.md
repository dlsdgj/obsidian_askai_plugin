# Ask AI 插件

一个在 Obsidian 中选中文本并调用 AI API 返回结果的插件，让您在阅读和写作时能够快速获取 AI 的帮助。

## 功能特点

- **文本选择调用 AI**：选中文本后自动显示悬浮按钮，点击即可调用 AI 分析或处理选中内容
- **多种 AI 服务支持**：内置支持 KIMI 和 DeepSeek 等 AI API，可在设置中配置
- **预设模板系统**：提供多个预设的提问模板，可快速应用不同场景的提问方式
- **上下文感知**：智能识别选中内容和上下文，使 AI 回答更精准
- **格式化工具**：提供清除格式功能，方便处理带有 Markdown 格式的文本
- **便捷操作**：支持复制 AI 回答、流式输出等便捷功能

## 安装方法

或者通过手动安装：
1. 下载最新的发布版本
2. 解压到 Obsidian 的插件目录（`.obsidian/plugins/`）
3. 重启 Obsidian 并在设置中启用插件

## 使用方法

### 基本使用

1. 在编辑器中选中文本
2. 选中文本后会显示一个悬浮按钮
3. 点击悬浮按钮，在弹出的菜单中选择 "编辑问题"
4. 在弹出的对话框中可以查看选中的内容，并可以编辑提问
5. 点击发送按钮或按 Enter 键提交问题
6. AI 的回答会实时显示在对话框中

### 使用模板

1. 选中文本并点击悬浮按钮
2. 鼠标悬停在 "编辑问题" 选项上，会显示模板二级菜单
3. 选择一个预设模板，插件会自动应用该模板并发送给 AI
4. 模板中会自动填充选中的内容（通过 `{{selection}}` 变量）和上下文（通过 `{{context}}` 变量）

### 通过命令调用

1. 选中文本
2. 打开命令面板（默认为 Ctrl+P）
3. 搜索并选择 "Ask AI about selection" 命令
4. 插件会直接打开对话框，您可以编辑提问并发送

## 配置选项

在插件设置中，您可以配置以下选项：

### AI API 配置
- 添加或修改 AI API 服务（URL、API Key、模型名称等）
- 设置默认使用的 AI API

### 模板配置
- 查看、编辑和添加预设模板
- 设置默认使用的模板

## 模板语法

模板中支持以下变量：

- `{{selection}}`：表示您在编辑器中选中的文本内容
- `{{context}}`：表示选中内容周围的上下文信息

示例模板：
```
请根据selection，按如下要求执行：
selection:{{selection}}

上下文：{{context}}

要求：
- 如果"selection"是英文单词则**仅翻译并给出其词源, 忽略其他要求**
- 如果"selection"是一段英文，请分别给出直译和接地气的中文翻译,并解释其中关键词句；
- 如果"selection"是中文词句段落，用大白话解释其含义；
- 如有上下文，请结合上下文进行说明,
**翻译仅限selection内容**。
```

## 高级功能

### 清除格式
在对话框中，点击 "清除格式" 按钮可以移除文本中的 Markdown 格式，包括：
- 加粗、斜体、删除线
- 行内代码
- 标题、横线
- 多余空行
- 序号和列表标记

### 复制回答
在对话框中，点击 "复制" 按钮可以复制 AI 的回答内容。如果您选择了部分文本，则仅复制选中的部分。

## 已知问题

- 如果悬浮图标太靠近视口边缘，菜单可能会自动调整位置以确保完全显示
- 如需使用自定义 API 密钥，请在设置中正确配置 API 信息

## 许可证

MIT License

## 更新日志

### 版本 1.0.1
- 修复了二级菜单模板重复显示的问题
- 优化了菜单位置计算逻辑
- 改进了模板处理方式

## 致谢

感谢您使用 Ask AI 插件！如有任何问题或建议，请在 GitHub 上提交 issue。

作者：nilmarkov
